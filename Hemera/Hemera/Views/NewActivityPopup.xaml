<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="Hemera.Views.NewActivityPopup"
    xmlns="http://xamarin.com/schemas/2014/forms"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:models="clr-namespace:Hemera.Models"
    xmlns:sh="clr-namespace:Sharpnado.Shades;assembly=Sharpnado.Shadows"
    xmlns:vm="clr-namespace:Hemera.ViewModels"
    x:Name="self"
    x:DataType="vm:NewActivityViewModel"
    BackgroundColor="#AA111111">
    <Grid RowDefinitions="*, 70">
        <BoxView
            Grid.Row="0"
            Grid.RowSpan="2"
            BackgroundColor="#AA111111">
            <BoxView.GestureRecognizers>
                <TapGestureRecognizer Command="{Binding ClosePopupCommand}" />
            </BoxView.GestureRecognizers>
        </BoxView>
        <Frame
            Grid.Row="0"
            Margin="0,-20,0,0"
            Padding="0"
            BackgroundColor="{AppThemeBinding Dark={StaticResource colorDarkTheme},
                                              Light={StaticResource colorLightTheme}}"
            CornerRadius="20">
            <Grid ColumnDefinitions="50,*,50" RowDefinitions="20, 50, *">
                <sh:Shadows
                    Grid.Row="1"
                    Grid.Column="0"
                    Grid.ColumnSpan="3"
                    Shades="{AppThemeBinding Dark={sh:SingleShade Offset='0,0.6',
                                                                  BlurRadius=2.1,
                                                                  Opacity=0.7,
                                                                  Color=#111111},
                                             Light={sh:SingleShade Offset='0,0.5',
                                                                   BlurRadius=2,
                                                                   Opacity=0.2,
                                                                   Color=#232323}}">
                    <Frame BackgroundColor="{AppThemeBinding Dark={StaticResource colorDarkTheme}, Light={StaticResource colorLightTheme}}" HasShadow="False" />
                </sh:Shadows>
                <Label
                    Grid.Row="1"
                    Grid.Column="1"
                    FontSize="16"
                    HorizontalOptions="Center"
                    HorizontalTextAlignment="Center"
                    Text="{Binding Header}"
                    TextColor="{AppThemeBinding Dark=White,
                                                Light=Black}"
                    VerticalOptions="Center" />
                <Path
                    Grid.Row="1"
                    Grid.Column="2"
                    Margin="0,0,10,0"
                    Data="M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"
                    Fill="{AppThemeBinding Dark=White,
                                           Light=Black}"
                    HorizontalOptions="End"
                    VerticalOptions="Center">
                    <Path.GestureRecognizers>
                        <TapGestureRecognizer Command="{Binding FinishCommand}" />
                    </Path.GestureRecognizers>
                </Path>
                <ContentView
                    Grid.Row="2"
                    Grid.Column="0"
                    Grid.ColumnSpan="3"
                    Margin="5,5,5,0"
                    Content="{Binding SwitchingContent}"
                    HorizontalOptions="Fill"
                    VerticalOptions="Fill" />
            </Grid>
        </Frame>

        <CollectionView
            Grid.Row="1"
            Margin="10,0,10,0"
            HeightRequest="50"
            ItemsSource="{Binding Categories}"
            VerticalOptions="Center">
            <CollectionView.ItemsLayout>
                <LinearItemsLayout ItemSpacing="10" Orientation="Horizontal" />
            </CollectionView.ItemsLayout>
            <CollectionView.ItemTemplate>
                <DataTemplate x:DataType="models:Category">
                    <Frame
                        Padding="0"
                        BackgroundColor="{Binding BackColor}"
                        CornerRadius="50"
                        HasShadow="False"
                        HeightRequest="50"
                        VerticalOptions="Center"
                        WidthRequest="50">
                        <Path
                            Margin="-2,-2,0,0"
                            Data="{Binding PathData}"
                            Fill="{Binding IconColor}"
                            HorizontalOptions="Center"
                            VerticalOptions="Center" />
                        <Frame.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding Path=BindingContext.SelectionChangedCommand, Source={x:Reference self}}" CommandParameter="{Binding .}" />
                        </Frame.GestureRecognizers>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
    </Grid>
</ContentPage>