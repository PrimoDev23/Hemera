<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="Hemera.Views.NewActivityPopup"
    xmlns="http://xamarin.com/schemas/2014/forms"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:models="clr-namespace:Hemera.Models"
    xmlns:sh="clr-namespace:Sharpnado.Shades;assembly=Sharpnado.Shadows"
    xmlns:vm="clr-namespace:Hemera.ViewModels"
    x:Name="self"
    x:DataType="vm:NewActivityViewModel"
    BackgroundColor="#AA111111">
    <Grid ColumnDefinitions="20, *, 20" RowDefinitions="20, *, 100">
        <Frame
            Grid.Row="1"
            Grid.Column="1"
            Padding="0"
            BackgroundColor="{AppThemeBinding Dark={StaticResource colorDarkTheme},
                                              Light={StaticResource colorLightTheme}}"
            CornerRadius="20">
            <Grid ColumnDefinitions="50,*,50" RowDefinitions="50, *">
                <sh:Shadows
                    Grid.Row="0"
                    Grid.Column="0"
                    Grid.ColumnSpan="3"
                    Shades="{AppThemeBinding Dark={sh:SingleShade Offset='0,0.6',
                                                                  BlurRadius=2.1,
                                                                  Opacity=0.7,
                                                                  Color=#111111},
                                             Light={sh:SingleShade Offset='0,0.5',
                                                                   BlurRadius=2,
                                                                   Opacity=0.2,
                                                                   Color=#232323}}">
                    <BoxView Color="{AppThemeBinding Dark={StaticResource colorDarkTheme}, Light={StaticResource colorLightTheme}}" />
                </sh:Shadows>
                <Label
                    Grid.Row="0"
                    Grid.Column="1"
                    FontSize="16"
                    HorizontalOptions="Center"
                    HorizontalTextAlignment="Center"
                    Text="{Binding CurrentCategory}"
                    TextColor="{AppThemeBinding Dark=White,
                                                Light=Black}"
                    VerticalOptions="Center" />
                <Path
                    Grid.Row="0"
                    Grid.Column="2"
                    Margin="0,0,10,0"
                    Data="M9 16.2L4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z"
                    Fill="{AppThemeBinding Dark=White,
                                           Light=Black}"
                    HorizontalOptions="End"
                    VerticalOptions="Center">
                    <Path.GestureRecognizers>
                        <TapGestureRecognizer Command="{Binding FinishCommand}" />
                    </Path.GestureRecognizers>
                </Path>
                <ScrollView
                    Grid.Row="1"
                    Grid.Column="0"
                    Grid.ColumnSpan="3"
                    Margin="5">
                    <ContentView
                        Content="{Binding SwitchingContent}"
                        HorizontalOptions="Fill"
                        VerticalOptions="Fill" />
                </ScrollView>
            </Grid>
        </Frame>

        <CollectionView
            Grid.Row="2"
            Grid.Column="1"
            HeightRequest="50"
            ItemsSource="{Binding Categories}"
            VerticalOptions="Center">
            <CollectionView.ItemsLayout>
                <LinearItemsLayout ItemSpacing="10" Orientation="Horizontal" />
            </CollectionView.ItemsLayout>
            <CollectionView.ItemTemplate>
                <DataTemplate x:DataType="models:Category">
                    <Frame
                        Padding="0"
                        BackgroundColor="{Binding BackColor}"
                        CornerRadius="50"
                        HasShadow="False"
                        HeightRequest="50"
                        VerticalOptions="Center"
                        WidthRequest="50">
                        <Path
                            Data="{Binding PathData}"
                            Fill="{Binding IconColor}"
                            HorizontalOptions="Center"
                            VerticalOptions="Center" />
                        <Frame.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding Path=BindingContext.SelectionChangedCommand, Source={x:Reference self}}" CommandParameter="{Binding .}" />
                        </Frame.GestureRecognizers>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
        <Grid.GestureRecognizers>
            <TapGestureRecognizer Command="{Binding ClosePopupCommand}" />
        </Grid.GestureRecognizers>
    </Grid>
</ContentPage>